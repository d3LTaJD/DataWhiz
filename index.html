<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>DataWhiz - Professional Data Analytics Platform</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/theme.css">
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <div class="logo">
          <img src="mind-map.png" alt="DataWhiz Logo" style="width: 100%; height: 100%; object-fit: contain;" />
        </div>
        <div class="title">DataWhiz</div>
      </div>
      <nav class="nav">
        <div class="item active">üè† Dashboard</div>
        <div class="item" onclick="uploadData()">‚¨ÜÔ∏è Upload Data</div>
        <div class="item" onclick="openAnalysisPage()">üìä Analysis</div>
        <div class="item" onclick="openMLPage()">ü§ñ Machine Learning</div>
        <div class="item" onclick="openSettingsPage()">‚öôÔ∏è Settings</div>
      </nav>
      <div style="flex:1;"></div>
      <div class="footer">v1.0 ‚Ä¢ ¬© DataWhiz</div>
    </aside>

    <main style="flex:1; display:flex; flex-direction:column;">
      <header class="header">
        <div style="width:20px;"></div>
        <div class="search" style="position: relative;">
          <input id="datasetSearchInput" placeholder="Search datasets, analyses..." />
          <div id="datasetSearchResults" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: var(--surface); border: 1px solid var(--divider); border-radius: 8px; margin-top: 4px; max-height: 400px; overflow-y: auto; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 1000;"></div>
        </div>
        <div style="width:20px;"></div>
        <button id="themeToggle" class="btn ghost">üåô Toggle Theme</button>
      </header>

      <section class="content">
        <div class="container">
          <div class="card">
            <div class="hero-title">Welcome to DataWhiz</div>
            <div class="hero-desc">Transform your data into powerful insights with our comprehensive analytics platform.</div>
            
            <!-- Quick Stats -->
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin: 20px 0;">
              <div style="text-align: center; padding: 20px; background: rgba(108,99,255,0.1); border-radius: 12px; border: 1px solid rgba(108,99,255,0.2);">
                <div style="font-size: 32px; font-weight: 700; color: var(--primary);">10+</div>
                <div style="font-size: 14px; color: var(--muted-2); font-weight: 500;">ML Models</div>
              </div>
              <div style="text-align: center; padding: 20px; background: rgba(0,201,167,0.1); border-radius: 12px; border: 1px solid rgba(0,201,167,0.2);">
                <div style="font-size: 32px; font-weight: 700; color: var(--accent);">8+</div>
                <div style="font-size: 14px; color: var(--muted-2); font-weight: 500;">Chart Types</div>
              </div>
              <div style="text-align: center; padding: 20px; background: rgba(255,184,107,0.1); border-radius: 12px; border: 1px solid rgba(255,184,107,0.2);">
                <div style="font-size: 32px; font-weight: 700; color: var(--warn);">25+</div>
                <div style="font-size: 14px; color: var(--muted-2); font-weight: 500;">Analytics Tools</div>
              </div>
              <div style="text-align: center; padding: 20px; background: rgba(255,107,107,0.1); border-radius: 12px; border: 1px solid rgba(255,107,107,0.2);">
                <div style="font-size: 32px; font-weight: 700; color: var(--danger);">‚àû</div>
                <div style="font-size: 14px; color: var(--muted-2); font-weight: 500;">Data Size</div>
              </div>
            </div>
            
            <div style="display:flex; gap:12px;">
              <button class="btn primary" onclick="launchAnalysis()">üöÄ Launch Full Dashboard</button>
              <button class="btn ghost" onclick="openTutorials()">üìö Documentation & Guide</button>
            </div>
          </div>

          <h3 style="color:var(--muted); margin:0 0 16px 0;">Core Features</h3>
          <div class="features">
            <div class="feature">
              <h4>üìä Data Management</h4>
              <p>Import, clean, and process data from multiple sources with advanced preprocessing tools.</p>
              <a class="learn" onclick="showFeatureDetails('Data Management')">Learn More</a>
            </div>
            <div class="feature">
              <h4>üìà Statistical Analysis</h4>
              <p>Comprehensive statistical testing, regression analysis, and advanced modeling capabilities.</p>
              <a class="learn" onclick="showFeatureDetails('Statistical Analysis')">Learn More</a>
            </div>
            <div class="feature">
              <h4>üìä Visualizations</h4>
              <p>Interactive charts, 3D plots, and exportable visualizations for data storytelling.</p>
              <a class="learn" onclick="showFeatureDetails('Visualizations')">Learn More</a>
            </div>
            <div class="feature">
              <h4>ü§ñ Machine Learning</h4>
              <p>10+ ML models including Random Forest, Gradient Boosting, K-Means clustering, and regression models.</p>
              <a class="learn" onclick="showFeatureDetails('Machine Learning')">Learn More</a>
            </div>
            <div class="feature">
              <h4>‚ö° High Performance</h4>
              <p>GPU acceleration, multi-threading, and optimized processing for large datasets.</p>
              <a class="learn" onclick="showFeatureDetails('High Performance')">Learn More</a>
            </div>
            <div class="feature">
              <h4>üîß Developer Tools</h4>
              <p>API integration, custom scripts, and extensible plugin architecture.</p>
              <a class="learn" onclick="showFeatureDetails('Developer Tools')">Learn More</a>
            </div>
          </div>

          <!-- Overview Section: Quick Overview + Development Notice -->
          <div class="overview-section">
            <!-- Quick Overview -->
            <div class="quick-overview">
              <h4>üìä Quick Overview</h4>
              <div class="quick-overview-content">
                <div class="quick-overview-item">
                  <h5>üíª System Requirements</h5>
                  <p>
                    <strong>OS:</strong> Windows 10+, macOS 10.14+, Linux<br>
                    <strong>RAM:</strong> 8GB minimum, 16GB recommended<br>
                    <strong>Storage:</strong> 2GB free space, SSD recommended<br>
                    <strong>CPU:</strong> Multi-core processor, 4+ cores<br>
                    <strong>GPU:</strong> Optional CUDA support
                  </p>
                </div>
                <div class="quick-overview-item">
                  <h5>üìÅ Supported Formats</h5>
                  <p>
                    <strong>Files:</strong> CSV, Excel (.xlsx), JSON<br>
                    <strong>Analysis:</strong> Business, Healthcare, Finance<br>
                    <strong>ML Models:</strong> Random Forest, Gradient Boosting, K-Means<br>
                    <strong>Charts:</strong> Line, Bar, Scatter, Pie, Geographic<br>
                    <strong>Export:</strong> PNG, PDF, downloadable reports
                  </p>
                </div>
              </div>
            </div>

            <!-- Development Notice Banner -->
            <div class="dev-notice">
              <div class="dev-notice-header">
                <span class="dev-notice-icon">üîß</span>
                <h4>‚ö† Development Phase</h4>
              </div>
              <p class="dev-notice-warning">
                This application is currently in active development. You may encounter issues while using the platform.
              </p>
              <ul class="dev-notice-list">
                <li>Errors and bugs</li>
                <li>Invalid or incomplete data</li>
                <li>Inaccurate analysis results</li>
                <li>Unstable features</li>
              </ul>
              <div class="dev-notice-footer">
                ‚ö† For Educational & Learning Purposes Only ‚ö†
              </div>
            </div>
          </div>

          <!-- Getting Started -->
          <div style="height: 20px;"></div>
          <div class="card">
            <div style="text-align: center; padding: 32px 24px;">
              <h3 style="color: var(--muted); margin: 0 0 8px 0; font-size: 24px;">Ready to get started?</h3>
              <p style="color: var(--muted-2); margin: 0 0 24px 0;">Launch the full DataWhiz workspace and start analyzing your data.</p>
              <div style="display: flex; gap: 12px; justify-content: center;">
                <button class="btn primary" onclick="launchAnalysis()">üöÄ Launch Dashboard</button>
                <button class="btn ghost" onclick="openTutorials()">üìö Documentation</button>
              </div>
            </div>
          </div>

        </div>
      </section>
    </main>
  </div>

  <!-- Feature Details Modal -->
  <div id="featureModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 10000; align-items: center; justify-content: center;">
    <div style="background: var(--surface); border-radius: 16px; padding: 32px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.5); border: 1px solid var(--divider);">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
        <h2 id="modalTitle" style="margin: 0; color: var(--primary); font-size: 28px;"></h2>
        <button onclick="closeFeatureModal()" style="background: none; border: none; color: var(--muted-2); font-size: 28px; cursor: pointer; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 8px; transition: all 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.1)'; this.style.color='var(--muted)'" onmouseout="this.style.background='none'; this.style.color='var(--muted-2)'">√ó</button>
      </div>
      <div id="modalContent" style="color: var(--muted-2); line-height: 1.6;"></div>
      <div style="margin-top: 24px; display: flex; gap: 12px; justify-content: flex-end;">
        <button class="btn ghost" onclick="closeFeatureModal()">Close</button>
      </div>
    </div>
  </div>

  <script>
    // Navigation functions
    function launchAnalysis() {
      window.location.href = 'analysis.html';
    }
    
    function uploadData() {
      window.location.href = 'analysis.html';
    }

    function openTutorials() {
      window.location.href = 'tutorials.html';
    }

    function openAnalysisPage() {
      window.location.href = 'analysis-info.html';
    }

    function openMLPage() {
      window.location.href = 'machine-learning-info.html';
    }

    function openSettingsPage() {
      window.location.href = 'settings.html';
    }

    // Feature details modal
    const featureDetails = {
      'Data Management': {
        title: 'üìä Data Management',
        content: `
          <p><strong>Powerful data import and preprocessing capabilities</strong></p>
          <ul style="margin: 16px 0; padding-left: 24px;">
            <li><strong>Supported Formats:</strong> CSV, Excel (.xlsx), JSON</li>
            <li>Upload and merge multiple files automatically</li>
            <li>Automatic data cleaning and preprocessing</li>
            <li>Handle missing values and data validation</li>
            <li>Quality checks and data profiling</li>
            <li>Preview and transform your datasets</li>
            <li>Export processed data for analysis</li>
          </ul>
          <p style="margin-top: 20px; color: var(--primary); font-weight: 600;">Start by uploading your CSV or Excel files to begin analysis.</p>
        `,
        action: 'uploadData'
      },
      'Statistical Analysis': {
        title: 'üìà Statistical Analysis',
        content: `
          <p><strong>Comprehensive statistical testing and analysis tools</strong></p>
          <ul style="margin: 16px 0; padding-left: 24px;">
            <li><strong>Descriptive Statistics:</strong> Mean, median, mode, variance</li>
            <li><strong>Distribution Analysis:</strong> Skewness, kurtosis, normality tests</li>
            <li><strong>Correlation Analysis:</strong> Pearson, Spearman correlations</li>
            <li><strong>Regression Models:</strong> Linear and logistic regression</li>
            <li><strong>Time Series:</strong> Trend analysis and forecasting</li>
            <li><strong>Quality Checks:</strong> Data completeness and accuracy</li>
            <li><strong>Summary Reports:</strong> Automated statistical summaries</li>
          </ul>
          <p style="margin-top: 20px; color: var(--primary); font-weight: 600;">Explore your data with powerful statistical insights.</p>
        `,
        action: 'launchAnalysis'
      },
      'Visualizations': {
        title: 'üìä Visualizations',
        content: `
          <p><strong>Create stunning, interactive data visualizations</strong></p>
          <ul style="margin: 16px 0; padding-left: 24px;">
            <li>Line, Bar, Scatter, and Pie charts</li>
            <li>Geographic visualizations and heatmaps</li>
            <li>Time series analysis graphs</li>
            <li>Multi-dimensional data views</li>
            <li>Interactive chart filtering</li>
            <li>Export to PNG, PDF, and SVG</li>
            <li>Custom color schemes and themes</li>
          </ul>
          <p style="margin-top: 20px; color: var(--primary); font-weight: 600;">Transform your data into compelling visual stories.</p>
        `,
        action: 'launchAnalysis'
      },
      'Machine Learning': {
        title: 'ü§ñ Machine Learning',
        content: `
          <p><strong>Advanced ML models for predictive analytics</strong></p>
          <ul style="margin: 16px 0; padding-left: 24px;">
            <li><strong>Random Forest:</strong> Classification and regression</li>
            <li><strong>Gradient Boosting:</strong> High-accuracy predictions</li>
            <li><strong>K-Means Clustering:</strong> Customer segmentation</li>
            <li><strong>Linear/Logistic Regression:</strong> Trend analysis</li>
            <li><strong>Demand Forecasting:</strong> Time series predictions</li>
            <li><strong>Churn Prediction:</strong> Customer retention</li>
            <li><strong>Anomaly Detection:</strong> Identify outliers</li>
            <li>Automated model training and validation</li>
            <li>Feature importance analysis</li>
            <li>Model performance metrics</li>
          </ul>
          <p style="margin-top: 20px; color: var(--primary); font-weight: 600;">Build powerful predictive models with your data.</p>
        `,
        action: 'launchAnalysis'
      },
      'High Performance': {
        title: '‚ö° High Performance',
        content: `
          <p><strong>Optimized for speed and efficiency</strong></p>
          <ul style="margin: 16px 0; padding-left: 24px;">
            <li>Multi-threaded data processing</li>
            <li>GPU acceleration support (CUDA)</li>
            <li>Efficient memory management</li>
            <li>Parallel computation capabilities</li>
            <li>Optimized algorithms for large datasets</li>
            <li>Fast data loading and caching</li>
            <li>Scalable architecture</li>
          </ul>
          <p style="margin-top: 20px; color: var(--primary); font-weight: 600;">Process millions of records in seconds.</p>
        `,
        action: null
      },
      'Developer Tools': {
        title: 'üîß Developer Tools',
        content: `
          <p><strong>Extensible platform for developers</strong></p>
          <ul style="margin: 16px 0; padding-left: 24px;">
            <li>RESTful API for integration</li>
            <li>WebSocket support for real-time data</li>
            <li>Custom Python scripts execution</li>
            <li>Plugin architecture</li>
            <li>Webhook integrations</li>
            <li>Advanced query builder</li>
            <li>Database schema inspector</li>
            <li>Custom visualization plugins</li>
          </ul>
          <p style="margin-top: 20px; color: var(--primary); font-weight: 600;">Extend and customize DataWhiz for your needs.</p>
        `,
        action: null
      }
    };

    let currentFeature = null;

    function showFeatureDetails(featureName) {
      const feature = featureDetails[featureName];
      if (!feature) return;
      
      currentFeature = feature;
      document.getElementById('modalTitle').textContent = feature.title;
      document.getElementById('modalContent').innerHTML = feature.content;
      
      const modal = document.getElementById('featureModal');
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden'; // Prevent background scrolling
    }

    function closeFeatureModal() {
      document.getElementById('featureModal').style.display = 'none';
      document.body.style.overflow = ''; // Restore scrolling
      currentFeature = null;
    }

    // Close modal on outside click
    document.getElementById('featureModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeFeatureModal();
      }
    });

    // Close modal on Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeFeatureModal();
      }
    });
    
    // theme toggle - toggles 'light' class on root element
    const btn = document.getElementById('themeToggle');
    btn.addEventListener('click', () => {
      document.documentElement.classList.toggle('light');
      // save preference - in Electron store later
      localStorage.setItem('dw-theme', document.documentElement.classList.contains('light') ? 'light' : 'dark');
    });
    // restore
    (function(){
      const t = localStorage.getItem('dw-theme');
      if (t === 'light') document.documentElement.classList.add('light');
    })();

    // Dataset Search Functionality
    const { ipcRenderer } = require('electron');
    const fs = require('fs');
    const path = require('path');
    let datasetsCatalog = [];
    let allDatasets = [];

    // Load datasets catalog
    function loadDatasetsCatalog() {
      try {
        const catalogPath = path.join(__dirname, 'datasets', 'datasets_catalog.json');
        const catalogData = fs.readFileSync(catalogPath, 'utf8');
        datasetsCatalog = JSON.parse(catalogData).datasets || [];
      } catch (error) {
        console.error('Error loading datasets catalog:', error);
        datasetsCatalog = [];
      }
    }

    // Scan datasets folder for actual files
    function scanDatasetsFolder() {
      try {
        const datasetsFolder = path.join(__dirname, 'datasets');
        const files = fs.readdirSync(datasetsFolder);
        
        const dataFiles = files.filter(file => {
          const ext = path.extname(file).toLowerCase();
          return (ext === '.csv' || ext === '.xlsx' || ext === '.xls') && 
                 file !== 'datasets_catalog.json';
        });

        // Create a map of catalog entries by filename
        const catalogMap = new Map();
        datasetsCatalog.forEach(dataset => {
          catalogMap.set(dataset.filename, dataset);
        });

        // Combine catalog entries with discovered files
        allDatasets = dataFiles.map(filename => {
          if (catalogMap.has(filename)) {
            return catalogMap.get(filename);
          } else {
            // Auto-generate entry for files not in catalog
            const name = path.basename(filename, path.extname(filename))
              .replace(/[_-]/g, ' ')
              .replace(/\b\w/g, l => l.toUpperCase());
            
            // Determine category from filename
            let category = 'business';
            const lowerFilename = filename.toLowerCase();
            if (lowerFilename.includes('healthcare') || lowerFilename.includes('health') || lowerFilename.includes('medical')) {
              category = 'healthcare';
            } else if (lowerFilename.includes('finance') || lowerFilename.includes('financial')) {
              category = 'finance';
            }

            return {
              id: filename.replace(/[^a-zA-Z0-9]/g, '_').toLowerCase(),
              filename: filename,
              name: name,
              category: category,
              description: `Dataset file: ${filename}`,
              keywords: [category, ...filename.split(/[_\s.-]+/).filter(w => w.length > 2).map(w => w.toLowerCase())],
              rows: 0,
              columns: 0,
              features: [],
              use_cases: []
            };
          }
        });

        console.log('Loaded datasets:', allDatasets.length);
      } catch (error) {
        console.error('Error scanning datasets folder:', error);
        // Fallback to catalog only
        allDatasets = datasetsCatalog;
      }
    }

    // Initialize datasets on load
    loadDatasetsCatalog();
    scanDatasetsFolder();

    // Search functionality
    const searchInput = document.getElementById('datasetSearchInput');
    const searchResults = document.getElementById('datasetSearchResults');

    searchInput.addEventListener('input', function(e) {
      const query = e.target.value.toLowerCase().trim();
      
      if (query.length < 2) {
        searchResults.style.display = 'none';
        return;
      }

      // Re-scan folder to pick up any newly added files
      scanDatasetsFolder();

      // Search datasets (search in filename, name, description, category, and keywords)
      const matchingDatasets = allDatasets.filter(dataset => {
        const allText = [
          dataset.filename,
          dataset.name,
          dataset.description || '',
          dataset.category || '',
          ...(dataset.keywords || [])
        ].join(' ').toLowerCase();
        
        return allText.includes(query);
      });

      if (matchingDatasets.length > 0) {
        displaySearchResults(matchingDatasets);
        searchResults.style.display = 'block';
      } else {
        displayNoResults();
        searchResults.style.display = 'block';
      }
    });

    // Hide results when clicking outside
    document.addEventListener('click', function(e) {
      if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
        searchResults.style.display = 'none';
      }
    });

    function displaySearchResults(datasets) {
      searchResults.innerHTML = datasets.map(dataset => `
        <div style="padding: 16px; border-bottom: 1px solid var(--divider); cursor: pointer; transition: background 0.2s;" 
             onmouseover="this.style.background='var(--surface-2)'" 
             onmouseout="this.style.background='var(--surface)'"
             onclick="downloadDataset('${dataset.filename}')">
          <div style="display: flex; align-items: center; gap: 12px;">
            <div style="width: 40px; height: 40px; background: rgba(108,99,255,0.1); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px;">
              üìä
            </div>
            <div style="flex: 1;">
              <h4 style="margin: 0 0 4px 0; color: var(--muted); font-size: 14px; font-weight: 600;">${dataset.name}</h4>
              <p style="margin: 0; color: var(--muted-2); font-size: 12px; line-height: 1.4;">${dataset.description}</p>
              <div style="margin-top: 8px; display: flex; gap: 8px; flex-wrap: wrap;">
                ${dataset.keywords.slice(0, 3).map(k => `<span style="background: rgba(108,99,255,0.1); color: var(--primary); padding: 2px 8px; border-radius: 4px; font-size: 10px;">${k}</span>`).join('')}
              </div>
            </div>
            <button class="btn primary" style="padding: 6px 16px; font-size: 12px;" onclick="event.stopPropagation(); downloadDataset('${dataset.filename}')">
              üì• Download
            </button>
          </div>
        </div>
      `).join('');
    }

    function displayNoResults() {
      searchResults.innerHTML = `
        <div style="padding: 24px; text-align: center; color: var(--muted-2);">
          <div style="font-size: 32px; margin-bottom: 8px;">üîç</div>
          <p style="margin: 0;">No datasets found matching your search</p>
        </div>
      `;
    }

    function downloadDataset(filename) {
      // Use ipcRenderer to communicate with main process
      ipcRenderer.invoke('show-save-dialog', {
        title: 'Save Dataset',
        defaultPath: filename,
        filters: [
          { name: 'CSV Files', extensions: ['csv'] },
          { name: 'Excel Files', extensions: ['xlsx', 'xls'] },
          { name: 'All Files', extensions: ['*'] }
        ]
      }).then(result => {
        if (!result.canceled && result.filePath) {
          const sourcePath = path.join(__dirname, 'datasets', filename);
          try {
            // Check if file exists
            if (!fs.existsSync(sourcePath)) {
              alert('Error: Dataset file not found: ' + filename);
              return;
            }
            fs.copyFileSync(sourcePath, result.filePath);
            alert('Dataset downloaded successfully!');
          } catch (error) {
            console.error('Download error:', error);
            alert('Error downloading dataset: ' + error.message);
          }
        }
      }).catch(error => {
        console.error('IPC error:', error);
        alert('Error: ' + error.message);
      });
    }

    // Make downloadDataset available globally
    window.downloadDataset = downloadDataset;
  </script>
</body>
</html>